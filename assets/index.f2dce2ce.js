import{_ as D}from"./index.4ef47345.js";/* empty css               *//* empty css              *//* empty css              *//* empty css              */import{b as B,f as I,g as y,n as x,u}from"./walletProvider.c245a119.js";/* empty css               */import{d as O,r as P,o as U,b as A,aK as H,B as _,C as g,aH as s,aG as c,u as k,aJ as w,aI as E,F as h,aD as v,aM as C,aN as G,aE as J,bd as K,be as W,bf as X,b9 as q,b8 as z,bc as Q,b2 as Y,bg as Z,bh as ee,bi as te,aX as oe,b3 as ae,aR as ne}from"./arco.2d71d886.js";import"./chart.be7017d0.js";import"./vue.8d2bace5.js";const se=f=>(K("data-v-42a60dfd"),f=f(),W(),f),re={style:{padding:"1rem"}},ce={class:"nft-footer"},ie=se(()=>h("br",null,null,-1)),de={class:"nft-footer"},le=C(" open "),_e=O({setup(f){const d=P({loading:!1,total:0,items:[]}),j=async(t,r)=>{const o=await fetch(r).then(a=>a.json()),e={token:t,name:`${o.name}`,image:`${o.image}`};if(o.attributes){const a=o.attributes.find(l=>l.trait_type==="Score");a&&(e.score=Number(a.value));const n=o.attributes.find(l=>l.trait_type==="Grade");n&&(e.grade=Number(n.value))}return e},$=async()=>{const t=u();if(t){d.loading=!0;const r=y.connect(x,t),o=await t.getAddress(),{total:e,rows:a}=await r.tokenOfOwnerList(o,0,10),n=await r.tokenURIList(a),l=await Promise.all(n.map((m,p)=>j(a[p].toNumber(),m)));d.total=e.toNumber(),d.items=l.sort((m,p)=>m.name.localeCompare(p.name)),d.loading=!1}},M=async t=>{const r=u();if(r){const o=y.connect(x,r);let e="",a=0;do{if(e=await o.tokenURI(t.token),console.log(e),e.endsWith("goldbox.json"))await new Promise(n=>{setTimeout(()=>{n()},3e3)});else{const n=await j(t.token,e);t.image=n.image,t.name=n.name,t.score=n.score}a+=1}while(e.includes("goldbox")&&a<10)}},R=async t=>{const r=u();if(r){t.loading=!0;try{await(await y.connect(x,r).openGoldBox(t.token)).wait(),await M(t)}catch(o){const{error:e,message:a}=o;console.error(o),ne.warning(e?e.data.message:a)}t.loading=!1}},b=()=>{$()},N=()=>{d.items=[],d.total=0};return U(()=>{B.on(b),I.on(N),u()&&b()}),A(()=>{B.off(b),I.off(N)}),(t,r)=>{const o=X,e=q,a=z,n=H("icon-more"),l=Q,m=Y,p=Z,F=ee,L=te,T=oe,V=ae;return _(),g("div",re,[s(V,{gutter:[10,10]},{default:c(()=>[k(d).loading?(_(),g(w,{key:0},E(4,(i,S)=>s(m,{key:S,xs:12,lg:6,xl:4},{default:c(()=>[s(l,{style:{"border-radius":"0.5rem"},"body-style":{padding:0},hoverable:""},{cover:c(()=>[s(e,{animation:""},{default:c(()=>[s(o,{class:"skeleton-image"})]),_:1})]),default:c(()=>[s(e,{style:{width:"80%",padding:"0.5rem"},animation:""},{default:c(()=>[s(a,{rows:2,"line-height":18})]),_:1}),h("div",ce,[s(n,{style:{width:"20px",height:"20px",float:"right",margin:"6px"}})])]),_:1})]),_:2},1024)),64)):(_(),g(w,{key:1},[k(d).items.length==0?(_(),v(p,{key:0})):(_(!0),g(w,{key:1},E(k(d).items,i=>(_(),v(m,{key:i.token,xs:12,lg:6,xl:4},{default:c(()=>[s(l,{style:{"border-radius":"0.5rem"},"body-style":{padding:0},hoverable:""},{cover:c(()=>[h("div",null,[s(F,{src:i.image,width:"100%",height:"100%",class:"nft-image"},null,8,["src"])])]),default:c(()=>[s(L,{title:`${i.name}  #${i.token}`,style:{padding:"0.5rem"}},{description:c(()=>[C(" Grade : "+G(i.grade)+" ",1),ie,C(" Score : "+G(i.score),1)]),_:2},1032,["title"]),h("div",de,[i.name==="Gold Box"?(_(),v(T,{key:0,type:"primary",status:"success",loading:i.loading,onClick:S=>R(i)},{default:c(()=>[le]),_:2},1032,["loading","onClick"])):J("",!0),s(n,{style:{width:"20px",height:"20px",float:"right",margin:"6px"}})])]),_:2},1024)]),_:2},1024))),128))],64))]),_:1})])}}});var we=D(_e,[["__scopeId","data-v-42a60dfd"]]);export{we as default};
