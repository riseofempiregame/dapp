import{_ as K}from"./index.b48f966f.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               */import{b as z,f as G,g as C,n as N,u as v}from"./walletProvider.27da813b.js";/* empty css               */import{d as W,r as R,o as X,b as q,aK as I,B as u,C as h,aH as t,aG as o,aE as Q,u as S,aJ as w,aI as T,F as x,aD as B,aM as c,aN as p,bd as Y,be as Z,bf as ee,b9 as te,b8 as oe,bc as ae,ba as ne,b2 as se,bg as ie,bh as re,bi as le,aX as ce,b3 as de,bj as _e,bk as me,a_ as fe,aR as ue}from"./arco.2d71d886.js";import"./chart.be7017d0.js";import"./vue.8d2bace5.js";const pe=y=>(Y("data-v-25dd38e8"),y=y(),Z(),y),ge={style:{padding:"1rem"}},be={class:"nft-footer"},he=pe(()=>x("br",null,null,-1)),ye={class:"nft-footer"},ke=c("0"),ve=c("0"),we=c(" 10000 "),xe=c("\u6388\u6743"),je=c(" 0 "),$e=c("\u6DFB\u52A0"),Ce=W({setup(y){R({item:{},nfts:[],loading:!1});const d=R({loading:!1,total:0,items:[]}),D=async(e,l)=>{const s=await fetch(l).then(i=>i.json()),a={token:e,name:`${s.name}`,image:`${s.image}`};if(s.attributes){const i=s.attributes.find(_=>_.trait_type==="Score");i&&(a.score=Number(i.value));const r=s.attributes.find(_=>_.trait_type==="Grade");r&&(a.grade=Number(r.value))}return a},L=async()=>{const e=v();if(e){d.loading=!0;const l=C.connect(N,e),s=await e.getAddress();let a=[],i=0,r=0;const _=10;do{const{rows:n}=await l.tokenOfOwnerList(s,r,_);console.log(r,_,n.map(g=>g.toNumber()));const f=await l.tokenURIList(n);a=[...a,...f.map((g,$)=>({token:n[$].toNumber(),loading:!0,uri:g}))],i=n.length,r+=_}while(i>0);d.total=a.length,d.items=a,d.loading=!1,d.items.forEach(n=>{D(n.token,n.uri).then(f=>{n.name=f.name,n.grade=f.grade,n.image=f.image,n.score=f.score}).catch(()=>{n.name="..",n.grade=0,n.image="",n.score=0})})}},V=async e=>{const l=v();if(l){const s=C.connect(N,l);let a="",i=0;do{if(a=await s.tokenURI(e.token),console.log(a),a.endsWith("goldbox.json"))await new Promise(r=>{setTimeout(()=>{r()},3e3)});else{const r=await D(e.token,a);e.image=r.image,e.name=r.name,e.score=r.score}i+=1}while(a.includes("goldbox")&&i<10)}},A=async e=>{const l=v();if(l){e.loading=!0;try{await(await C.connect(N,l).openGoldBox(e.token)).wait(),await V(e)}catch(s){const{error:a,message:i}=s;console.error(s),ue.warning(a?a.data.message:i)}e.loading=!1}},j=()=>{L()},E=()=>{d.items=[],d.total=0};return X(()=>{z.on(j),G.on(E),v()&&j()}),q(()=>{z.off(j),G.off(E)}),(e,l)=>{const s=ee,a=te,i=oe,r=I("icon-more"),_=ae,n=ne,f=se,g=ie,$=re,O=le,b=ce,U=I("icon-bar-chart"),P=I("icon-share-internal"),F=de,k=_e,H=me,J=fe;return u(),h("div",ge,[t(F,null,{default:o(()=>[Q("",!0),t(F,{style:{flex:"1"},gutter:[10,10]},{default:o(()=>[S(d).loading?(u(),h(w,{key:0},T(4,(m,M)=>t(f,{key:M,xs:12,lg:6,xl:4},{default:o(()=>[t(_,{style:{"border-radius":"0.5rem"},"body-style":{padding:0},hoverable:""},{cover:o(()=>[t(a,{animation:""},{default:o(()=>[t(s,{class:"skeleton-image"})]),_:1})]),default:o(()=>[t(a,{style:{width:"80%",padding:"0.5rem"},animation:""},{default:o(()=>[t(i,{rows:2,"line-height":18})]),_:1}),x("div",be,[t(r,{style:{width:"20px",height:"20px",float:"right",margin:"6px"}})])]),_:1})]),_:2},1024)),64)):(u(),h(w,{key:1},[S(d).items.length==0?(u(),B(g,{key:0})):(u(!0),h(w,{key:1},T(S(d).items,m=>(u(),B(f,{key:m.token,xs:12,lg:6,xl:4},{default:o(()=>[t(_,{style:{"border-radius":"0.5rem"},"body-style":{padding:0},hoverable:""},{cover:o(()=>[x("div",null,[t($,{src:m.image,width:"100%",height:"100%",class:"nft-image"},null,8,["src"])])]),default:o(()=>[t(O,{title:`${m.name}  #${m.token}`,style:{padding:"0.5rem"}},{description:o(()=>[c(p(e.$t("nft.grade"))+" : "+p(m.grade)+" ",1),he,c(" "+p(e.$t("nft.score"))+" : "+p(m.score),1)]),_:2},1032,["title"]),x("div",ye,[t(n,null,{default:o(()=>[m.name==="Gold Box"?(u(),B(b,{key:0,type:"primary",status:"success",loading:m.loading,onClick:M=>A(m)},{default:o(()=>[c(p(e.$t("nft.open")),1)]),_:2},1032,["loading","onClick"])):(u(),h(w,{key:1},[t(b,{size:"small"},{icon:o(()=>[t(U)]),default:o(()=>[c(" "+p(e.$t("nft.upgrade")),1)]),_:1}),t(b,{size:"small"},{icon:o(()=>[t(P)]),default:o(()=>[c(" "+p(e.$t("nft.transfer")),1)]),_:1})],64))]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))],64))]),_:1})]),_:1}),t(J,{visible:!1,title:e.$t("nft.upgrade")},{default:o(()=>[t(H,{title:e.$t("nft.consume"),column:1},{default:o(()=>[t(k,{label:"ID"},{default:o(()=>[ke]),_:1}),t(k,{label:e.$t("nft.grade")},{default:o(()=>[ve]),_:1},8,["label"]),t(k,{label:e.$t("nft.roemp")},{default:o(()=>[t(n,null,{default:o(()=>[we,t(b,{type:"primary",size:"small"},{default:o(()=>[xe]),_:1})]),_:1})]),_:1},8,["label"]),t(k,{label:e.$t("nft.NFT")},{default:o(()=>[t(n,null,{default:o(()=>[je,t(b,{type:"primary",size:"small"},{default:o(()=>[$e]),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["title"])]),_:1},8,["title"])])}}});var Ve=K(Ce,[["__scopeId","data-v-25dd38e8"]]);export{Ve as default};
