import{_ as W}from"./index.19de93d7.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               */import{b as M,f as G,g as N,n as S,u as v}from"./walletProvider.81b87b9e.js";/* empty css               */import{d as X,r as R,o as q,b as Q,aK as w,B as f,C as b,aH as e,aG as t,aE as Y,u as I,aJ as x,aI as T,F as j,aD as B,bd as Z,aM as d,aN as p,be as ee,bf as te,bg as oe,b9 as ne,b8 as ae,bc as se,ba as ie,b2 as re,bh as le,bi as ce,bj as de,aX as _e,b3 as me,bk as ue,bl as fe,a_ as pe,aR as ge}from"./arco.1070c694.js";import"./chart.ba7f08d0.js";import"./vue.cb3a4e20.js";const he=y=>(ee("data-v-5880d118"),y=y(),te(),y),be={style:{padding:"1rem"}},ye={class:"nft-footer"},ke=he(()=>j("br",null,null,-1)),ve={class:"nft-footer"},we=d("0"),xe=d("0"),je=d(" 10000 "),$e=d("\u6388\u6743"),Ce=d(" 0 "),Ne=d("\u6DFB\u52A0"),Se=X({setup(y){R({item:{},nfts:[],loading:!1});const _=R({loading:!1,total:0,items:[]}),D=async(o,l)=>{const s=await fetch(l).then(i=>i.json()),n={token:o,name:`${s.name}`,image:`${s.image}`};if(s.attributes){const i=s.attributes.find(m=>m.trait_type==="Score");i&&(n.score=Number(i.value));const r=s.attributes.find(m=>m.trait_type==="Grade");r&&(n.grade=Number(r.value))}return n},L=async()=>{const o=v();if(o){_.loading=!0;const l=N.connect(S,o),s=await o.getAddress();let n=[],i=0,r=0;const m=10;do{const{rows:a}=await l.tokenOfOwnerList(s,r,m);console.log(r,m,a.map(g=>g.toNumber()));const u=await l.tokenURIList(a);n=[...n,...u.map((g,C)=>({token:a[C].toNumber(),loading:!0,uri:g}))],i=a.length,r+=m}while(i>0);_.total=n.length,_.items=n,_.loading=!1,_.items.forEach(a=>{a.loading=!1,D(a.token,a.uri).then(u=>{a.name=u.name,a.grade=u.grade,a.image=u.image,a.score=u.score}).catch(()=>{a.name="..",a.grade=0,a.image="",a.score=0})})}},V=async o=>{const l=v();if(l){const s=N.connect(S,l);let n="",i=0;do{if(n=await s.tokenURI(o.token),console.log(n),n.endsWith("goldbox.json"))await new Promise(r=>{setTimeout(()=>{r()},3e3)});else{const r=await D(o.token,n);o.image=r.image,o.name=r.name,o.score=r.score}i+=1}while(n.includes("goldbox")&&i<10)}},A=async o=>{const l=v();if(l){o.loading=!0;try{await(await N.connect(S,l).openGoldBox(o.token)).wait(),await V(o)}catch(s){const{error:n,message:i}=s;console.error(s),ge.warning(n?n.data.message:i)}o.loading=!1}},$=()=>{L()},E=()=>{_.items=[],_.total=0};return q(()=>{M.on($),G.on(E),v()&&$()}),Q(()=>{M.off($),G.off(E)}),(o,l)=>{const s=oe,n=ne,i=ae,r=w("icon-more"),m=se,a=ie,u=re,g=le,C=ce,O=de,U=w("icon-thunderbolt"),h=_e,P=w("icon-bar-chart"),H=w("icon-share-internal"),z=me,k=ue,J=fe,K=pe;return f(),b("div",be,[e(z,null,{default:t(()=>[Y("",!0),e(z,{style:{flex:"1"},gutter:[10,10]},{default:t(()=>[I(_).loading?(f(),b(x,{key:0},T(4,(c,F)=>e(u,{key:F,xs:12,lg:6,xl:4},{default:t(()=>[e(m,{style:{"border-radius":"0.5rem"},"body-style":{padding:0},hoverable:""},{cover:t(()=>[e(n,{animation:""},{default:t(()=>[e(s,{class:"skeleton-image"})]),_:1})]),default:t(()=>[e(n,{style:{width:"80%",padding:"0.5rem"},animation:""},{default:t(()=>[e(i,{rows:2,"line-height":18})]),_:1}),j("div",ye,[e(r,{style:{width:"20px",height:"20px",float:"right",margin:"6px"}})])]),_:1})]),_:2},1024)),64)):(f(),b(x,{key:1},[I(_).items.length==0?(f(),B(g,{key:0})):(f(!0),b(x,{key:1},T(I(_).items,c=>(f(),B(u,{key:c.token,xs:12,lg:6,xl:4},{default:t(()=>[e(m,{style:{"border-radius":"0.5rem"},"body-style":{padding:0},hoverable:""},{cover:t(()=>[j("div",null,[e(C,{src:c.image,width:"100%",height:"100%",class:"nft-image"},null,8,["src"])])]),default:t(()=>[e(O,{title:`${c.name}  #${c.token}`,style:{padding:"0.5rem",height:"75px"}},Z({_:2},[c.score?{name:"description",fn:t(()=>[d(p(o.$t("nft.grade"))+" : "+p(c.grade)+" ",1),ke,d(" "+p(o.$t("nft.score"))+" : "+p(c.score),1)])}:void 0]),1032,["title"]),j("div",ve,[e(a,null,{default:t(()=>[c.name==="Gold Box"?(f(),B(h,{key:0,type:"primary",size:"small",status:"success",loading:c.loading,onClick:F=>A(c)},{icon:t(()=>[e(U)]),default:t(()=>[d(" "+p(o.$t("nft.open")),1)]),_:2},1032,["loading","onClick"])):(f(),b(x,{key:1},[e(h,{size:"small"},{icon:t(()=>[e(P)]),default:t(()=>[d(" "+p(o.$t("nft.upgrade")),1)]),_:1}),e(h,{size:"small"},{icon:t(()=>[e(H)]),default:t(()=>[d(" "+p(o.$t("nft.transfer")),1)]),_:1})],64))]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))],64))]),_:1})]),_:1}),e(K,{visible:!1,title:o.$t("nft.upgrade")},{default:t(()=>[e(J,{title:o.$t("nft.consume"),column:1},{default:t(()=>[e(k,{label:"ID"},{default:t(()=>[we]),_:1}),e(k,{label:o.$t("nft.grade")},{default:t(()=>[xe]),_:1},8,["label"]),e(k,{label:o.$t("nft.roemp")},{default:t(()=>[e(a,null,{default:t(()=>[je,e(h,{type:"primary",size:"small"},{default:t(()=>[$e]),_:1})]),_:1})]),_:1},8,["label"]),e(k,{label:o.$t("nft.NFT")},{default:t(()=>[e(a,null,{default:t(()=>[Ce,e(h,{type:"primary",size:"small"},{default:t(()=>[Ne]),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["title"])]),_:1},8,["title"])])}}});var Oe=W(Se,[["__scopeId","data-v-5880d118"]]);export{Oe as default};
